# Go Query Builder (QB)

**QueryBuilder** ‚Äî —ç—Ç–æ –º–æ—â–Ω—ã–π –∏ –≥–∏–±–∫–∏–π SQL-–±–∏–ª–¥–µ—Ä –¥–ª—è Go, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—â–∏–π —É–¥–æ–±–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–∞–∑–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö MySQL

## üöÄ –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ SQL-–∑–∞–ø—Ä–æ—Å–æ–≤ —á–µ—Ä–µ–∑ **—Ü–µ–ø–æ—á–∫—É –º–µ—Ç–æ–¥–æ–≤** (fluent interface).
- –ü–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ **—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π**.
- **–ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ** —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∑–∞–ø—Ä–æ—Å–æ–≤ (Memory | Redis).
- –ü–∞–∫–µ—Ç–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ `INSERT` –∏ `UPDATE`.
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ **"—Å—ã—Ä—ã—Ö"** SQL-–∑–∞–ø—Ä–æ—Å–æ–≤.
- –†–∞–∑–ª–∏—á–Ω—ã–µ —Ç–∏–ø—ã `JOIN`-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π.
- –£—Å–ª–æ–≤–∏—è `WHERE` —Å **–≤–ª–æ–∂–µ–Ω–Ω—ã–º–∏ –≥—Ä—É–ø–ø–∞–º–∏**.
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ **–ø–æ–¥–∑–∞–ø—Ä–æ—Å–æ–≤**.

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
go get github.com/antibomberman/qb@v1.2.19
```

## üí° –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

–ù–∏–∂–µ –ø—Ä–∏–≤–µ–¥–µ–Ω –ø—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –æ –ø—Ä–æ–¥—É–∫—Ç–µ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.

```go
package main

import (
	"database/sql"
	"log"
	"time"

	"github.com/antibomberman/qb"
	_ "github.com/go-sql-driver/mysql" // –∏–ª–∏ –¥—Ä—É–≥–æ–π –¥—Ä–∞–π–≤–µ—Ä
)

// Product –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã 'products'
type Product struct {
	ID        int        `db:"id"`
	Name      string     `db:"name"`
	Active    bool       `db:"active"`
	CreatedAt time.Time  `db:"created_at"`
	DeletedAt *time.Time `db:"deleted_at"`
}

func main() {
	// 1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î
	db, err := sql.Open("mysql", "root:rootpassword@tcp(localhost:3316)/test_db")
	if err != nil {
		log.Fatalf("–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö: %v", err)
	}
	defer db.Close()

	// 2. –°–æ–∑–¥–∞–Ω–∏–µ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ Query Builder
	queryBuilder := qb.New("mysql", db)

	// –ü—Ä–∏–º–µ—Ä 1: –ü—Ä–æ—Å—Ç–æ–µ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ SQL-–∑–∞–ø—Ä–æ—Å–∞ –∏ –µ–≥–æ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤
	sqlQuery, args, err := queryBuilder.From("products").Where("id = ?", 1).ToSql()
	if err != nil {
		log.Fatalf("–û—à–∏–±–∫–∞ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞: %v", err)
	}
	log.Printf("–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π SQL: %s\n–ê—Ä–≥—É–º–µ–Ω—Ç—ã: %v\n", sqlQuery, args)

	// –ü—Ä–∏–º–µ—Ä 2: –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞ –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ –æ–¥–Ω–æ–π –∑–∞–ø–∏—Å–∏
	var product Product
	found, err := queryBuilder.
		From("products").
		Where("active = ?", true).
		WhereNull("deleted_at").
		OrderBy("created_at", "DESC").
		Get(&product) // –ò—Å–ø–æ–ª—å–∑—É–µ–º Get –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –æ–¥–Ω–æ–π –∑–∞–ø–∏—Å–∏

	if err != nil {
		log.Fatalf("–û—à–∏–±–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞: %v", err)
	}
	if !found {
		log.Println("–ü—Ä–æ–¥—É–∫—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω")
		return
	}
	log.Printf("–ù–∞–π–¥–µ–Ω–Ω—ã–π –ø—Ä–æ–¥—É–∫—Ç: %+v", product)
}
```

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–ë–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏ –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤—ã –Ω–∞–π–¥–µ—Ç–µ –≤ –Ω–∞—à–µ–π [–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏](docs/ru.md).

## ü§ù –ö–∞–∫ –≤–Ω–µ—Å—Ç–∏ –≤–∫–ª–∞–¥

–ú—ã —Ä–∞–¥—ã –ª—é–±–æ–º—É –≤–∫–ª–∞–¥—É! –ü–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º –∫–æ–º–º–∏—Ç–∞, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤–∞—à –∫–æ–¥ –æ—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω –∏ –≤—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç —É—Å–ø–µ—à–Ω–æ:

```bash
gofmt -s -w . && go test -v ./...
```
